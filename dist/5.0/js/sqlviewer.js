var viewname,editorAce,editorResult,mode,editor,converted="",old="",json="";function performShowHideToHtml(e){null==e&&(e="editor"),$("#"+e).hasClass("hide")?($("#"+e).removeClass("hide"),$("#result1").addClass("hide"),$("#showHideBtn").val("Show Output"),"csv-to-html-converter"!==$("#viewName").val().toLowerCase()&&"tsv-to-html-converter"!==$("#viewName").val().toLowerCase()&&editorAce.setValue($("#excelToHtmlData").text())):($("#result1").removeClass("hide"),$("#"+e).addClass("hide"),$("#showHideBtn").val("Show HTML"))}function setToEditor(e){editorAce.setValue(e),"sql-to-csv-converter"==viewname?sqlTOcsv():"sql-to-html-converter"==viewname?sqlTOhtml():"sql-to-json-converter"==viewname?sqlTOjson():"sql-to-xml-converter"==viewname?sqlTOxml():"sql-to-yaml-converter"==viewname?sqlTOyaml():"sqlformatter"==viewname&&FormatSQL()}function sqlTOcsv(){var e=editorAce.getValue();try{if(null!=e&&0!=e.trim().length){if(-1==e.toLowerCase().search("create"))return editorResult.setValue("Missing CREATE STATEMENT"),!1;if(-1==e.toLowerCase().search("select"))return editorResult.setValue("Missing SELECT STATEMENT"),!1;var t=(new SQL.Database).exec(e),r="";$.each(t,(function(e,o){1!=t.length&&(r+="TABLE "+(e+1)+"\n",r+="-------\n"),r+=o.columns.join()+"\n",$.each(o.values,(function(e,t){r+=t.join()+"\n"})),1!=t.length&&(r+="-------\n")})),editorResult.setValue(r),setOutputMsg("SQL TO CSV")}}catch(e){editorResult.setValue(e.message)}}function sqlTOhtml(){var e=editorAce.getValue();try{if(null!=e&&0!=e.trim().length){if(-1==e.toLowerCase().search("create"))return editorResult.setValue("Missing CREATE STATEMENT"),!1;if(-1==e.toLowerCase().search("select"))return editorResult.setValue("Missing SELECT STATEMENT"),!1;var t=(new SQL.Database).exec(e),r="<center>";$.each(t,(function(e,o){1!=t.length&&(r+="============= TABLE-"+(e+1)+" ============= "),r+="<table border = '1' class='display'><thead><tr>";for(var a=0;a<o.columns.length;a++)r+="<th>"+o.columns[a]+"</th>";r+="</tr></thead><tbody>",$.each(o.values,(function(e,t){r+="<tr>",$.each(t,(function(e,t){r+="<td>"+t+"</td>"})),r+="</tr>"})),1!=t.length&&(r+="</tbody></table><br>")})),r+="</center>",editorResult.setValue(r);var o="<!DOCTYPE html><html>\n";o+="<head><meta charset='UTF-8'><title>SQL To HTML using codebeautify.org</title></head>\n",o+="<body>\n",o+=r,o+="\n</body>\n",o+="</html>",$("#templTableDiv").text(vkbeautify.xml(o)),editorResult.setValue(vkbeautify.xml(o)),htmlOutput(),setOutputMsg("SQL TO HTML")}}catch(e){editorResult.setValue(e.message)}}function htmlOutput(){$("#result1").show();var e=editorResult.getValue();if(e.trim().length>0){var t=document.getElementById("result1").contentWindow.document;old!=e&&(old=e,t.open(),t.write(old),t.close()),$("html, body").animate({scrollTop:0},10)}}function sqlTOjson(){var e=editorAce.getValue();try{if(null!=e&&0!=e.trim().length){if(-1==e.toLowerCase().search("create"))return openErrorDialog("Missing CREATE STATEMENT"),!1;if(-1==e.toLowerCase().search("select"))return openErrorDialog("Missing SELECT STATEMENT"),!1;var t=(new SQL.Database).exec(e),r="[";$.each(t,(function(e,o){$.each(o.values,(function(e,t){var a="{";$.each(t,(function(e,r){a+='"'+o.columns[e]+'"  :"'+r+'"',t.length!=e+1&&(a+=",")})),a+="}",o.values.length!=e+1&&(a+=","),r+=a})),t.length!=e+1&&(r+=",")})),r+="]",editor.set($.parseJSON(r)),$("#templTableDiv").text(r),setOutputMsg("SQL TO JSON")}}catch(e){editor.set(e.message)}}function sqlTOxml(){var e=editorAce.getValue();try{if(null!=e&&0!=e.trim().length){if(-1==e.toLowerCase().search("create"))return editorResult.setValue("Missing CREATE STATEMENT"),!1;if(-1==e.toLowerCase().search("select"))return editorResult.setValue("Missing SELECT STATEMENT"),!1;var t=(new SQL.Database).exec(e),r="[";$.each(t,(function(e,o){$.each(o.values,(function(e,t){var a="{";$.each(t,(function(e,r){a+='"'+o.columns[e]+'"  :"'+r+'"',t.length!=e+1&&(a+=",")})),a+="}",o.values.length!=e+1&&(a+=","),r+=a})),t.length!=e+1&&(r+=",")})),r+="]";var o,a=(new XML.ObjTree).writeXML(JSON.parse(r));a=decodeSpecialCharacter(a);try{o=$.parseXML(a)}catch(e){o=!1}0==o&&(a=a.substr(0,39)+"<root>"+a.substr(39)+"</root>"),editorResult.setValue(vkbeautify.xml(a)),setOutputMsg("SQL TO XML")}}catch(e){editorResult.setValue(e.message)}}function sqlTOyaml(){var e=editorAce.getValue();try{if(null!=e&&0!=e.trim().length){if(-1==e.toLowerCase().search("create"))return editorResult.setValue("Missing CREATE STATEMENT"),!1;if(-1==e.toLowerCase().search("select"))return editorResult.setValue("Missing SELECT STATEMENT"),!1;var t=(new SQL.Database).exec(e),r="[";$.each(t,(function(e,o){$.each(o.values,(function(e,t){var a="{";$.each(t,(function(e,r){a+='"'+o.columns[e]+'"  :"'+r+'"',t.length!=e+1&&(a+=",")})),a+="}",o.values.length!=e+1&&(a+=","),r+=a})),t.length!=e+1&&(r+=",")})),r+="]";try{e=json2yaml(r.trim()),editorResult.setValue(e)}catch(e){var o="";o=o+"Error : "+e.message,o=(o+="\n")+"Line : "+e.parsedLine+"  "+e.snippet,editorResult.setValue(o)}setOutputMsg("SQL TO YAML")}}catch(e){editorResult.setValue(e.message)}}function FormatSQL(){editorResult.getSession().setUseWrapMode(!0);var e=editorAce.getValue();e.trim().length>0&&($.ajax({type:"post",url:globalurl+"Ql/formateQL",dataType:"text",data:{data:e},success:function(e){try{editorResult.setValue(e)}catch(e){openErrorDialog("Error..!")}},error:function(e,t,r){openErrorDialog("Failed to load data="+t)}}),setOutputMsg("Beautify SQL"))}function MinifySQL(){editorResult.getSession().setUseWrapMode(!0);var e=editorAce.getValue();e.trim().length>0&&($.ajax({type:"post",url:globalurl+"Ql/minifyQL",dataType:"text",data:{data:e},success:function(e){try{editorResult.setValue(e)}catch(e){openErrorDialog("invalid SQL")}},error:function(e,t,r){openErrorDialog("Failed Minifining="+t)}}),setOutputMsg("Minify SQL"))}function removeCommentsSQL(){editorResult.getSession().setUseWrapMode(!0);var e=editorAce.getValue();e.trim().length>0&&($.ajax({type:"post",url:globalurl+"Ql/removeCommentsQL",dataType:"text",data:{data:e},success:function(e){try{editorResult.setValue(e)}catch(e){openErrorDialog("invalid SQL")}},error:function(e,t,r){openErrorDialog("Failed Minifining="+t)}}),setOutputMsg("SQL without comments"))}$(document).ready((function(){if("sql-to-csv-converter"==(viewname=$("#viewName").val().trim()))setViewTitle("SQL TO CSV Converter",!0,!0),createEditor("sql","text");else if("sql-to-html-converter"==viewname)setViewTitle("SQL TO HTML Converter",!0,!0),createEditor("sql","html");else if("sql-to-json-converter"==viewname){(mode=document.getElementById("mode")).onchange=function(){editor.setMode(mode.value),showJSON(!0)};var e=document.getElementById("jsoneditor"),t={mode:mode.value,error:function(e){openErrorDialog(e.toString())}};editor=new JSONEditor(e,t,json),setViewTitle("SQL TO JSON Converter",!0,!0),createEditor("sql")}else"sql-to-xml-converter"==viewname?(setViewTitle("SQL TO XML Converter",!0,!0),createEditor("sql","xml")):"sql-to-yaml-converter"==viewname?(setViewTitle("SQL TO YAML Converter",!0,!0),createEditor("xml","yaml")):"sqlformatter"==viewname&&(setViewTitle("SQL Formatter",!0,!0),createEditor("sql","sql"))}));