/*!

Name: Open Weather
Dependencies: jQuery, OpenWeatherMap API
Author: Michael Lynch
Author URL: http://michaelynch.com
Date Created: August 28, 2013
Licensed under the MIT license

*/
!function(t){t.fn.openWeather=function(e){if(!this.length)return this;var n,s=this,i=t(this);s.settings={},s.settings=t.extend({},{descriptionTarget:null,maxTemperatureTarget:null,minTemperatureTarget:null,windSpeedTarget:null,humidityTarget:null,sunriseTarget:null,sunsetTarget:null,placeTarget:null,iconTarget:null,customIcons:null,units:"c",city:null,lat:null,lng:null,key:null,success:function(){},error:function(t){}},e),null!=s.settings.city?n="http://api.openweathermap.org/data/2.5/weather?q="+s.settings.city.replace(" ",""):null!=s.settings.lat&&null!=s.settings.lng&&(n="http://api.openweathermap.org/data/2.5/weather?lat="+s.settings.lat+"&lon="+s.settings.lng),null!=s.settings.key&&(n+="&APPID="+s.settings.key);var a=function(t){var e=new Date(1e3*t),n=e.getHours();n>12&&(hoursRemaining=24-n,n=12-hoursRemaining);var s=e.getMinutes();return(s=s.toString()).length<2&&(s=0+s),n+":"+s};t.ajax({type:"GET",url:n,dataType:"jsonp",success:function(e){if("f"==s.settings.units)var n=Math.round(1.8*(e.main.temp-273.15)+32)+"°F",r=Math.round(1.8*(e.main.temp_min-273.15)+32)+"°F",l=Math.round(1.8*(e.main.temp_max-273.15)+32)+"°F";else n=Math.round(e.main.temp-273.15)+"°C",r=Math.round(e.main.temp_min-273.15)+"°C",l=Math.round(e.main.temp_max-273.15)+"°C";if(i.html(n),null!=s.settings.minTemperatureTarget&&t(s.settings.minTemperatureTarget).text(r),null!=s.settings.maxTemperatureTarget&&t(s.settings.maxTemperatureTarget).text(l),t(s.settings.descriptionTarget).text(e.weather[0].description),null!=s.settings.iconTarget&&null!=e.weather[0].icon){if(null!=s.settings.customIcons){var u,g,o=e.weather[0].icon;g=-1!=o.indexOf("d")?"day":"night","01d"!=o&&"01n"!=o||(u="clear"),"02d"!=o&&"02n"!=o&&"03d"!=o&&"03n"!=o&&"04d"!=o&&"04n"!=o||(u="clouds"),"09d"!=o&&"09n"!=o&&"10d"!=o&&"10n"!=o||(u="rain"),"11d"!=o&&"11n"!=o||(u="storm"),"13d"!=o&&"13n"!=o||(u="snow"),"50d"!=o&&"50n"!=o||(u="mist");var m="/img/icons/weather/"+g+"/"+u+".png";alert}else m="http://openweathermap.org/img/w/"+e.weather[0].icon+".png";t(s.settings.iconTarget).attr("src",m)}if(null!=s.settings.placeTarget&&t(s.settings.placeTarget).text(e.name+", "+e.sys.country),null!=s.settings.windSpeedTarget&&t(s.settings.windSpeedTarget).text(Math.round(e.wind.speed)+" Mph"),null!=s.settings.humidityTarget&&t(s.settings.humidityTarget).text(e.main.humidity+"%"),null!=s.settings.sunriseTarget){var c=a(e.sys.sunrise);t(s.settings.sunriseTarget).text(c+" AM")}if(null!=s.settings.sunsetTarget){var p=a(e.sys.sunset);t(s.settings.sunsetTarget).text(p+" PM")}s.settings.success.call(this)},error:function(t,e,n){s.settings.error.call(this,e)}})}}(jQuery);